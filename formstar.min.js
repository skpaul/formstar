!function(e){e.fn.formstar=function(t){var r=e(this),a=e.extend({format:"auto",ajax:!0,extraData:null,beforeValidation:null,onValidation:null,afterValidation:null,beforeSend:null,onResponse:null,successUndefined:null,onSuccess:null,beforeSuccessMessage:null,onSuccessMessage:null,afterSuccessMessage:null,successButton:null,onFail:null,failMessage:null,failButton:null,beforeRedirect:null,onRedirect:null,onError:null,errorButton:null,errorMessage:null,onComplete:null,reset:!0,beforeReset:null,onReset:null,afterReset:null},t),s=r.attr("action"),n=r.attr("method"),i=e(this).find("button[type=submit]"),o="",l=i.find("span.buttonText"),u=i.find("span.buttonIcon");function d(t,r){e.sweetModal({content:t,icon:e.sweetModal.ICON_WARNING}),r.addClass("error"),e("html,body").animate({scrollTop:r.offset().top-50},1e3),r.focus()}function f(){a.beforeSend?a.beforeSend(r):(0!==l.length?(o=l.html(),l.html("Wait…"),u.html(),u.addClass("spinner").html("autorenew").css("color","#A3B9D8")):(o=i.html(),i.html("Wait…")),i.attr("disabled","disabled"))}function c(t){if(a.onResponse)a.onResponse(t,r);else{if(void 0===t.issuccess)return a.successUndefined?a.successUndefined(t,r):(i.removeAttr("disabled"),0!==l.length?(l.html(o),u.removeClass("spinner").html("arrow_forward").css("color","#A3B9D8")):i.html(o),alert("Problem in getting response from server. Please try again.")),!1;t.issuccess?a.onSuccess?a.onSuccess(t,r):(void 0!==t.message&&(a.beforeSuccessMessage&&a.beforeSuccessMessage(t,r),a.onSuccessMessage?a.onSuccessMessage(t,r):e.sweetModal({content:t.message,icon:e.sweetModal.ICON_SUCCESS}),a.afterSuccessMessage&&a.afterSuccessMessage(t,r),a.successButton?a.successButton(i):(i.removeAttr("disabled"),0!==l.length?(l.html(o),u.removeClass("spinner").html("arrow_forward").css("color","#A3B9D8")):i.html(o)),a.reset&&(a.beforeReset&&a.beforeReset(r),a.onReset?a.onReset(r):((s=r).trigger("reset"),e("select.resetIt",s).each((function(){var t=e(this).attr("data-default-value"),r=e(this).attr("data-default-text");e(this).empty().append('<option value="'+t+'">'+r+"</option>")})),e("select.emptyIt",s).empty(),e(s).find("input:visible:first").focus()),a.afterReset&&a.afterReset(r))),void 0!==t.redirecturl&&(a.beforeRedirect&&a.beforeRedirect(),a.onRedirect?a.onRedirect(t.redirecturl):window.location=t.redirecturl)):a.onFail?a.onFail(t,r):(a.failMessage?a.failMessage(t.message):e.sweetModal({content:t.message,icon:e.sweetModal.ICON_WARNING}),a.failButton?a.failButton(i):(i.removeAttr("disabled"),0!==l.length?(l.html("Try again"),u.removeClass("spinner").html("arrow_forward").css("color","#A3B9D8")):i.html("Try again")))}var s}function g(t,r,s){a.onError?a.onError(t,r,s,i):(a.errorButton?a.errorButton(i):0!==l?(l.html("Try again"),u.removeClass("spinner").html("arrow_forward").css("color","#A3B9D8")):i.html("Try again"),a.errorMessage?a.errorMessage(t,r,s):function(t,r,a){var s="Failed to execute.\n";switch(r){case"timeout":s+="Operation timeout. Pleasy try again.",s+="\n "+t.statusText+" ("+t.status+")";break;case"error":s+="An error ouccured.",s+="\n "+t.statusText+" ("+t.status+")";break;case"abort":s+="Request aborted.",s+="\n "+t.statusText+" ("+t.status+")";break;case"parsererror":s+="Parser error.",s+="\n "+t.statusText+" ("+t.status+")";break;default:s+="An unexpected error occured.",s+="\n "+t.statusText+" ("+t.status+")";break}e.sweetModal({content:s,icon:e.sweetModal.ICON_WARNING})}(t,r))}function m(){a.onComplete?a.onComplete(r):i.removeAttr("disabled")}function b(e,t,r,a){var s=e.val(),n=e.attr("data-title");if(""==s)return d("<strong>"+n+"</strong> required.",e),!1;var i=e[0],o=i.files[0];s.split("\\");if(!/^([a-zA-Z0-9\s_\\.\-:])+(.jpeg|.jpg)$/.test(s.toLowerCase()))return d("<strong>"+n+"</strong> invalid. Please select a .jpg file.",e),!1;for(var l=o.size,u=new Array("Bytes","KB","MB","GB"),f=0;l>900;)l/=1024,f++;var c=Math.round(100*l)/100,g=u[f];if("KB"!=g)return d("<strong>"+n+"</strong> size is too large. Maximum size is 100 kilobytes.",e),!1;if(c>t)return d("<strong>"+n+"</strong> size is too large. Maximum size is 100 kilobytes.",e),!1;if("undefined"!=typeof FileReader){var m=new FileReader;m.readAsDataURL(i.files[0]),m.onload=function(t){var s=new Image;s.src=t.target.result,s.onload=function(){return this.width!=a?(d("<strong>"+n+"</strong> width invalid. Width must be "+a+" pixel.",e),!1):this.height!=r?(d("<strong>"+n+"</strong> height invalid. Height must be "+r+" pixel.",e),!1):void 0}}}return!0}r.on("submit",(function(t){t.preventDefault(),t.stopPropagation();var i=!1;if(!a.beforeValidation||0!=a.beforeValidation(r)){if(a.onValidation){if(0==a.onValidation(r))return}else r.find(".validate").each((function(t,r){var a=e(this),s=a.attr("data-title");void 0===s&&(s=a.parent(".field").find("label").html());var n=a.attr("data-datatype"),o=a.val();if(!a.parent(".field").hasClass("hidden")){var l=a.closest(".toggleVisibleWrapper");if(void 0===l||!l.hasClass("hidden")){var u=a.attr("data-unicode");if(!1!==u&&void 0!==u){if("no"==u&&""!=e.trim(String(o))){if(x(e.trim(String(o))))return i=!0,d("<strong>"+s+"</strong> : Unicode not allowed",a),!1}}else if(""!=e.trim(String(o))){if(x(e.trim(String(o))))return i=!0,d("<strong>"+s+"</strong> : Unicode not allowed.",a),!1}var f=a.attr("data-required");if(!1!==f&&void 0!==f){if(a.is(":checkbox"))if(!a.is(":checked"))return i=!0,d("<strong>"+s+"</strong> required.",a),!1;if("required"==f&&""==o)return i=!0,d("<strong>"+s+"</strong> required.",a),!1}var c="characters";if(!1!==(n=a.attr("data-datatype"))&&void 0!==n){var g=e.trim(o).length;if("required"==f||"optional"==f&&g>0)switch(n){case"letters":if(!/^[a-z\s]+$/i.test(o))return i=!0,message=s+" invalid.",d(message,a),!1;break;case"email":if(!/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(o))return i=!0,d(s+" invalid.",a),!1;break;case"mobile":if(c="digits",!function(e){if(""==(e=e.trim()))return!1;if(isNaN(e))return!1;if(e.length<10)return!1;var t=["013","014","015","016","017","018","019"];if(e.startsWith("1")){if(10!=e.length)return!1;var r="0"+e.substr(0,2);return!!t.includes(r)}if(e.startsWith("01")){if(11!=e.length)return!1;r=e.substr(0,3);return!!t.includes(r)}if(e.startsWith("8801")){if(13!=e.length)return!1;r=e.substr(2,3);return!!t.includes(r)}return!1}(o))return i=!0,d("<strong>"+s+"</strong> invalid.",a),!1;break;case"integer":case"float":case"double":case"decimal":if(c="digits",isNaN(o))return i=!0,d("<strong>"+s+"</strong> must be a valid number.",a),!1;break;case"date":if(!moment(o,"DD-MM-YYYY").isValid())return i=!0,d("<strong>"+s+"</strong> invalid.",a),!1;break;default:break}}var m=a.attr("data-minlen");if(!1!==m&&void 0!==m){g=e.trim(o).length;if(m=parseInt(m),("required"==f||"optional"==f&&g>0)&&g<m)return i=!0,d("<strong>"+s+"</strong> must be equal or greater than "+m+" "+c+".",a),!1}var h=a.attr("data-maxlen");if(!1!==h&&void 0!==h){g=e.trim(o).length;if(h=parseInt(h),("required"==f||"optional"==f&&g>0)&&g>h)return i=!0,d("<strong>"+s+"</strong> must be equal or less than "+h+" "+c+".",a),!1}var p=a.attr("data-exactlen");if(!1!==p&&void 0!==p){g=e.trim(o).length;if(p=parseInt(p),("required"==f||"optional"==f&&g>0)&&g!==p)return i=!0,d("<strong>"+s+"</strong> must have "+p+" "+c+".",a),!1}var v=a.attr("data-minval");if(!1!==v&&void 0!==v){if(!1!==n&&void 0===n)return i=!0,d("Datatype undefined for <strong>"+s+"</strong>.",a),!1;g=e.trim(o).length;if("required"==f||"optional"==f&&g>0){if(("integer"==n||"float"==n||"double"==n||"decimal"==n)&&isNaN(o))return i=!0,d("<strong>"+s+"</strong> must be a valid number.",a),!1;switch(n){case"integer":o=parseInt(o),v=parseInt(v);break;case"float":case"double":case"decimal":o=parseFloat(o),v=parseFloat(v);break;case"date":if(!(o=moment(o,"DD-MM-YYYY")).isValid())return i=!0,d("<strong>"+s+"</strong> invalid.",a),!1;v=moment(v,"DD-MM-YYYY");break;default:return i=!0,d("Datatype undefined for <strong>"+s+"</strong>.",a),!1}if(o<v)return i=!0,d("<strong>"+s+"</strong> must be equal or greater than "+v+".",a),!1}}var M=a.attr("data-maxval");if(!1!==M&&void 0!==M){if(!1!==n&&void 0===n)return i=!0,d("Datatype undefined for "+s+".",a),!1;g=e.trim(o).length;if("required"==f||"optional"==f&&g>0){if(("integer"==n||"float"==n||"double"==n||"decimal"==n)&&isNaN(o))return i=!0,d("<strong>"+s+"</strong> must be a valid number.",a),!1;switch(n){case"integer":o=parseInt(o),M=parseInt(M);break;case"float":case"double":case"decimal":o=parseFloat(o),M=parseFloat(M);break;case"date":if(!(o=moment(o,"DD-MM-YYYY")).isValid())return i=!0,d(s+" invalid.",a),!1;M=moment(M,"DD-MM-YYYY");break;default:return i=!0,d("Datatype undefined for <strong>"+s+"</strong>.",a),!1}if(o>M)return i=!0,d("<strong>"+s+"</strong> must be equal or less than "+M+".",a),!1}}var w=a.attr("data-exactval");if(!1!==w&&void 0!==w){if(!1!==n&&void 0===n)return i=!0,d("Datatype undefined for "+s+".",a),!1;g=e.trim(o).length;if("required"==f||"optional"==f&&g>0){if(("integer"==n||"float"==n||"double"==n||"decimal"==n)&&isNaN(o))return i=!0,d("<strong>"+s+"</strong> must be a valid number.",a),!1;switch(n){case"integer":o=parseInt(o),w=parseInt(w);break;case"float":case"double":case"decimal":o=parseFloat(o),w=parseFloat(w);break;case"date":if(!(o=moment(o,"DD-MM-YYYY")).isValid())return i=!0,d("<strong>"+s+"</strong> invalid.",a),!1;w=moment(w,"DD-MM-YYYY");break;default:return i=!0,d("Datatype undefined for <strong>"+s+"</strong>.",a),!1}if(o!=w)return i=!0,d("<strong>"+s+"</strong> must be equal to "+w+".",a),!1}}if(a.hasClass("photo")){var D=a.attr("data-maxkb"),y=a.attr("data-height"),Y=a.attr("data-width");if(!b(a,parseInt(D),parseInt(y),parseInt(Y)))return i=!0,!1}if(a.hasClass("signature")){D=a.attr("data-maxkb"),y=a.attr("data-height"),Y=a.attr("data-width");if(!b(a,parseInt(D),parseInt(y),parseInt(Y)))return i=!0,!1}a.removeClass("error")}}function x(e){for(var t=0,r=e.length;t<r;t++)if(e.charCodeAt(t)>255)return!0;return!1}}));if(i)i=!1;else if(!a.afterValidation||0!=a.afterValidation(r))if(a.ajax){if("auto"==a.format){let t=new FormData(this);0==e.isEmptyObject(a.extraData)&&e.each(a.extraData,(function(e,r){t.append(e,r)})),function(t){e.ajax({data:t,cache:!1,contentType:!1,processData:!1,type:n,url:s,beforeSend:f,success:c,error:g,complete:m})}(t)}}else f(),e(r).unbind("submit"),e(r).submit()}}))}}(jQuery);