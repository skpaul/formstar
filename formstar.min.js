!function(t){t.fn.formstar=function(e){var r=t(this),a=t.extend({format:"auto",extraData:null,ajax:!0,beforeValidation:null,validationRules:null,afterValidation:null,beforeSend:null,success:null,beforeRedirect:null,error:null,complete:null,reset:!0},e),i=r.attr("action"),s=r.attr("method"),n=t(this).find("button[type=submit]"),o="",l=n.find("span.buttonText"),d=n.find("span.buttonIcon");function u(e,r){t.sweetModal({content:e,icon:t.sweetModal.ICON_WARNING}),r.addClass("error"),t("html,body").animate({scrollTop:r.offset().top-50},1e3),r.focus()}function f(){a.beforeSend?a.beforeSend():(0!==l.length?(o=l.html(),l.html("Wait…"),d.html(),d.addClass("spinner").html("autorenew").css("color","#A3B9D8")):(o=n.html(),n.html("Wait…")),n.attr("disabled","disabled"))}function c(e){if(a.success)a.success(e);else{if(void 0===e.issuccess)return n.removeAttr("disabled"),0!==l.length?(l.html(o),d.removeClass("spinner").html("arrow_forward").css("color","#A3B9D8")):n.html(o),alert("Problem in getting response from server. Please try again."),!1;e.issuccess?(void 0!==e.message&&(t.sweetModal({content:e.message,icon:t.sweetModal.ICON_SUCCESS}),n.removeAttr("disabled"),0!==l.length?(l.html(o),d.removeClass("spinner").html("arrow_forward").css("color","#A3B9D8")):n.html(o),a.reset&&((i=r).trigger("reset"),t("select.resetIt",i).each((function(){var e=t(this).attr("data-default-value"),r=t(this).attr("data-default-text");t(this).empty().append('<option value="'+e+'">'+r+"</option>")})),t("select.emptyIt",i).empty(),t(i).find("input:visible:first").focus())),void 0!==e.redirecturl&&(a.beforeRedirect&&a.beforeRedirect(),window.location=e.redirecturl)):(t.sweetModal({content:e.message,icon:t.sweetModal.ICON_WARNING}),n.removeAttr("disabled"),0!==l.length?(l.html("Try again"),d.removeClass("spinner").html("arrow_forward").css("color","#A3B9D8")):n.html("Try again"))}var i}function m(e,r,i){0!==l?(l.html("Try again"),d.removeClass("spinner").html("arrow_forward").css("color","#A3B9D8")):n.html("Try again"),a.error?a.error(e,r,i):function(e,r,a){var i="Failed to execute.\n";switch(r){case"timeout":i+="Operation timeout. Pleasy try again.",i+="\n "+e.statusText+" ("+e.status+")";break;case"error":i+="An error ouccured.",i+="\n "+e.statusText+" ("+e.status+")";break;case"abort":i+="Request aborted.",i+="\n "+e.statusText+" ("+e.status+")";break;case"parsererror":i+="Parser error.",i+="\n "+e.statusText+" ("+e.status+")";break;default:i+="An unexpected error occured.",i+="\n "+e.statusText+" ("+e.status+")";break}t.sweetModal({content:i,icon:t.sweetModal.ICON_WARNING})}(e,r)}function g(){a.complete?a.complete():n.removeAttr("disabled")}function h(t,e,r,a){var i=t.val(),s=t.attr("data-title");if(""==i)return u("<strong>"+s+"</strong> required.",t),!1;var n=t[0],o=n.files[0];i.split("\\");if(!/^([a-zA-Z0-9\s_\\.\-:])+(.jpeg|.jpg)$/.test(i.toLowerCase()))return u("<strong>"+s+"</strong> invalid. Please select a .jpg file.",t),!1;for(var l=o.size,d=new Array("Bytes","KB","MB","GB"),f=0;l>900;)l/=1024,f++;var c=Math.round(100*l)/100,m=d[f];if("KB"!=m)return u("<strong>"+s+"</strong> size is too large. Maximum size is 100 kilobytes.",t),!1;if(c>e)return u("<strong>"+s+"</strong> size is too large. Maximum size is 100 kilobytes.",t),!1;if("undefined"!=typeof FileReader){var g=new FileReader;g.readAsDataURL(n.files[0]),g.onload=function(e){var i=new Image;i.src=e.target.result,i.onload=function(){return this.width!=a?(u("<strong>"+s+"</strong> width invalid. Width must be "+a+" pixel.",t),!1):this.height!=r?(u("<strong>"+s+"</strong> height invalid. Height must be "+r+" pixel.",t),!1):void 0}}}return!0}r.on("submit",(function(e){e.preventDefault(),e.stopPropagation();var n=!1;if(!a.beforeValidation||0!=a.beforeValidation()){if(a.validationRules){if(0==a.validationRules())return}else r.find(".validate").each((function(e,r){var a=t(this),i=a.attr("data-title");void 0===i&&(i=a.parent(".field").find("label").html());var s=a.attr("data-datatype"),o=a.val();if(!a.parent(".field").hasClass("hidden")){var l=a.closest(".toggleVisibleWrapper");if(void 0===l||!l.hasClass("hidden")){if(""!=t.trim(String(o))){let e=function(t){for(var e=0,r=t.length;e<r;e++)if(t.charCodeAt(e)>255)return!0;return!1}(t.trim(String(o)));if(e)return n=!0,u("<strong>"+i+"</strong> must be in english",a),!1}var d=a.attr("data-required");if(!1!==d&&void 0!==d){if(a.is(":checkbox"))if(!a.is(":checked"))return n=!0,u("<strong>"+i+"</strong> required.",a),!1;if("required"==d&&""==o)return n=!0,u("<strong>"+i+"</strong> required.",a),!1}var f="characters";if(!1!==(s=a.attr("data-datatype"))&&void 0!==s){var c=t.trim(o).length;if("required"==d||"optional"==d&&c>0)switch(s){case"letters":if(!/^[a-z\s]+$/i.test(o))return n=!0,message=i+" invalid.",u(message,a),!1;break;case"email":if(!/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(o))return n=!0,u(i+" invalid.",a),!1;break;case"mobile":if(f="digits",!function(t){if(""==(t=t.trim()))return!1;if(isNaN(t))return!1;if(t.length<10)return!1;var e=["013","014","015","016","017","018","019"];if(t.startsWith("1")){if(10!=t.length)return!1;var r="0"+t.substr(0,2);return!!e.includes(r)}if(t.startsWith("01")){if(11!=t.length)return!1;r=t.substr(0,3);return!!e.includes(r)}if(t.startsWith("8801")){if(13!=t.length)return!1;r=t.substr(2,3);return!!e.includes(r)}return!1}(o))return n=!0,u("<strong>"+i+"</strong> invalid.",a),!1;break;case"integer":case"float":case"double":case"decimal":if(f="digits",isNaN(o))return n=!0,u("<strong>"+i+"</strong> must be a valid number.",a),!1;break;case"date":if(!moment(o,"DD-MM-YYYY").isValid())return n=!0,u("<strong>"+i+"</strong> invalid.",a),!1;break;default:break}}var m=a.attr("data-minlen");if(!1!==m&&void 0!==m){c=t.trim(o).length;if(m=parseInt(m),("required"==d||"optional"==d&&c>0)&&c<m)return n=!0,u("<strong>"+i+"</strong> must be equal or greater than "+m+" "+f+".",a),!1}var g=a.attr("data-maxlen");if(!1!==g&&void 0!==g){c=t.trim(o).length;if(g=parseInt(g),("required"==d||"optional"==d&&c>0)&&c>g)return n=!0,u("<strong>"+i+"</strong> must be equal or less than "+g+" "+f+".",a),!1}var b=a.attr("data-exactlen");if(!1!==b&&void 0!==b){c=t.trim(o).length;if(b=parseInt(b),("required"==d||"optional"==d&&c>0)&&c!==b)return n=!0,u("<strong>"+i+"</strong> must have "+b+" "+f+".",a),!1}var p=a.attr("data-minval");if(!1!==p&&void 0!==p){if(!1!==s&&void 0===s)return n=!0,u("Datatype undefined for <strong>"+i+"</strong>.",a),!1;c=t.trim(o).length;if("required"==d||"optional"==d&&c>0){if(("integer"==s||"float"==s||"double"==s||"decimal"==s)&&isNaN(o))return n=!0,u("<strong>"+i+"</strong> must be a valid number.",a),!1;switch(s){case"integer":o=parseInt(o),p=parseInt(p);break;case"float":case"double":case"decimal":o=parseFloat(o),p=parseFloat(p);break;case"date":if(!(o=moment(o,"DD-MM-YYYY")).isValid())return n=!0,u("<strong>"+i+"</strong> invalid.",a),!1;p=moment(p,"DD-MM-YYYY");break;default:return n=!0,u("Datatype undefined for <strong>"+i+"</strong>.",a),!1}if(o<p)return n=!0,u("<strong>"+i+"</strong> must be equal or greater than "+p+".",a),!1}}var v=a.attr("data-maxval");if(!1!==v&&void 0!==v){if(!1!==s&&void 0===s)return n=!0,u("Datatype undefined for "+i+".",a),!1;c=t.trim(o).length;if("required"==d||"optional"==d&&c>0){if(("integer"==s||"float"==s||"double"==s||"decimal"==s)&&isNaN(o))return n=!0,u("<strong>"+i+"</strong> must be a valid number.",a),!1;switch(s){case"integer":o=parseInt(o),v=parseInt(v);break;case"float":case"double":case"decimal":o=parseFloat(o),v=parseFloat(v);break;case"date":if(!(o=moment(o,"DD-MM-YYYY")).isValid())return n=!0,u(i+" invalid.",a),!1;v=moment(v,"DD-MM-YYYY");break;default:return n=!0,u("Datatype undefined for <strong>"+i+"</strong>.",a),!1}if(o>v)return n=!0,u("<strong>"+i+"</strong> must be equal or less than "+v+".",a),!1}}var w=a.attr("data-exactval");if(!1!==w&&void 0!==w){if(!1!==s&&void 0===s)return n=!0,u("Datatype undefined for "+i+".",a),!1;c=t.trim(o).length;if("required"==d||"optional"==d&&c>0){if(("integer"==s||"float"==s||"double"==s||"decimal"==s)&&isNaN(o))return n=!0,u("<strong>"+i+"</strong> must be a valid number.",a),!1;switch(s){case"integer":o=parseInt(o),w=parseInt(w);break;case"float":case"double":case"decimal":o=parseFloat(o),w=parseFloat(w);break;case"date":if(!(o=moment(o,"DD-MM-YYYY")).isValid())return n=!0,u("<strong>"+i+"</strong> invalid.",a),!1;w=moment(w,"DD-MM-YYYY");break;default:return n=!0,u("Datatype undefined for <strong>"+i+"</strong>.",a),!1}if(o!=w)return n=!0,u("<strong>"+i+"</strong> must be equal to "+w+".",a),!1}}if(a.hasClass("photo")){var D=a.attr("data-maxkb"),y=a.attr("data-height"),Y=a.attr("data-width");if(!h(a,parseInt(D),parseInt(y),parseInt(Y)))return n=!0,!1}if(a.hasClass("signature")){D=a.attr("data-maxkb"),y=a.attr("data-height"),Y=a.attr("data-width");if(!h(a,parseInt(D),parseInt(y),parseInt(Y)))return n=!0,!1}a.removeClass("error")}}}));var o;if(n)n=!1;else if(!a.afterValidation||0!=a.afterValidation())if(a.ajax){if("auto"==a.format){let e=new FormData(this);0==t.isEmptyObject(a.extraData)&&t.each(a.extraData,(function(t,r){e.append(t,r)})),o=e,t.ajax({data:o,cache:!1,contentType:!1,processData:!1,type:s,url:i,beforeSend:f,success:c,error:m,complete:g})}}else f(),t(r).unbind("submit"),t(r).submit()}}))}}(jQuery);